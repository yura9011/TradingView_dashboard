{% extends "base.html" %}

{% block title %}Dashboard • TradingAI{% endblock %}

{% block content %}
<div class="dashboard-header">
    <h1>Analysis Dashboard</h1>
    <p class="subtitle">AI-powered technical analysis with Wyckoff & Elliott Wave methodology</p>
</div>

<!-- Stats Summary -->
<div class="stats-summary">
    <div class="stat-card">
        <h3>{{ signals|length }}</h3>
        <p>Total Analyzed</p>
    </div>
    <div class="stat-card candidate">
        <h3>{{ signals|selectattr('signal_type', 'equalto', 'candidate')|list|length }}</h3>
        <p>Candidates</p>
    </div>
    <div class="stat-card pending">
        <h3>{{ signals|selectattr('signal_type', 'equalto', 'pending')|list|length }}</h3>
        <p>Pending Review</p>
    </div>
    <div class="stat-card">
        <h3>{{ signals|selectattr('signal_type', 'equalto', 'not_candidate')|list|length }}</h3>
        <p>Not Viable</p>
    </div>
</div>

<!-- Signals Table -->
<div class="signals-table-container">
    <table class="signals-table">
        <thead>
            <tr>
                <th>Symbol</th>
                <th>Status</th>
                <th>Confidence</th>
                <th>Trend</th>
                <th>Wyckoff Phase</th>
                <th>Pattern</th>
                <th>Analyzed</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for signal in signals %}
            <tr>
                <td class="symbol">{{ signal.symbol }}</td>
                <td>
                    {% if signal.signal_type == 'candidate' %}
                    <span class="badge badge-success">Candidate</span>
                    {% elif signal.signal_type == 'not_candidate' %}
                    <span class="badge badge-danger">Not Viable</span>
                    {% else %}
                    <span class="badge badge-warning">Pending</span>
                    {% endif %}
                </td>
                <td>
                    <div class="progress-bar">
                        <div class="progress" style="width: {{ (signal.confidence * 100)|int }}%"></div>
                        <span>{{ (signal.confidence * 100)|int }}%</span>
                    </div>
                </td>
                <td>
                    {% if signal.trend == 'up' %}
                    <span class="trend-up">↑ Bullish</span>
                    {% elif signal.trend == 'down' %}
                    <span class="trend-down">↓ Bearish</span>
                    {% else %}
                    <span class="trend-sideways">→ Sideways</span>
                    {% endif %}
                </td>
                <td>
                    {% if signal.market_phase %}
                    <span class="phase-{{ signal.market_phase }}">{{ signal.market_phase|title }}</span>
                    {% else %}
                    <span class="phase-unclear">—</span>
                    {% endif %}
                </td>
                <td>{{ signal.pattern|replace('_', ' ')|title if signal.pattern and signal.pattern != 'none' else '—' }}</td>
                <td style="color: var(--text-muted); font-size: 0.85rem;">{{ signal.timestamp[:10] if signal.timestamp else '—' }}</td>
                <td>
                    <a href="/signal/{{ signal.id }}" class="btn btn-secondary" style="padding: 6px 14px; font-size: 0.8rem;">View</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="8" class="empty-state">
                    <p>No analysis results yet</p>
                    <code>python main_multiagent_local.py --symbol AAPL</code>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
